#config-version=FG100F-7.2.4-FW-build1396-230131:opmode=0:vdom=0:user=admin
#conf_file_ver=1234567890
#buildno=1396
#global_vdom=1

config system global
    set admintimeout 60
    set alias "FortiGate-100F"
    set hostname "FG-CORP-FW01"
    set timezone "America/New_York"
end

config system interface
    edit "wan1"
        set vdom "root"
        set ip 203.0.113.1 255.255.255.0
        set allowaccess ping https ssh
        set type physical
        set role wan
    next
    edit "lan"
        set vdom "root"
        set ip 192.168.1.1 255.255.255.0
        set allowaccess ping https ssh
        set type physical
        set role lan
    next
    edit "dmz"
        set vdom "root"
        set ip 10.10.10.1 255.255.255.0
        set allowaccess ping
        set type physical
        set role dmz
    next
end

config firewall address
    edit "Internal-Network"
        set subnet 192.168.1.0 255.255.255.0
    next
    edit "DMZ-Servers"
        set subnet 10.10.10.0 255.255.255.0
    next
    edit "Web-Server"
        set subnet 10.10.10.10 255.255.255.255
    next
    edit "Mail-Server"
        set subnet 10.10.10.20 255.255.255.255
    next
end

config firewall service custom
    edit "HTTPS-8443"
        set tcp-portrange 8443
    next
end

config firewall policy
    edit 1
        set name "Allow-LAN-to-Internet"
        set srcintf "lan"
        set dstintf "wan1"
        set action accept
        set srcaddr "Internal-Network"
        set dstaddr "all"
        set schedule "always"
        set service "ALL"
        set nat enable
        set logtraffic all
        set comments "Allow internal users to access internet"
    next
    edit 2
        set name "Allow-LAN-to-DMZ"
        set srcintf "lan"
        set dstintf "dmz"
        set action accept
        set srcaddr "Internal-Network"
        set dstaddr "DMZ-Servers"
        set schedule "always"
        set service "HTTP" "HTTPS" "SSH"
        set logtraffic all
    next
    edit 3
        set name "DMZ-Web-Server-Inbound"
        set srcintf "wan1"
        set dstintf "dmz"
        set action accept
        set srcaddr "all"
        set dstaddr "Web-Server"
        set schedule "always"
        set service "HTTP" "HTTPS"
        set nat enable
        set logtraffic all
        set comments "Allow inbound web traffic to DMZ web server"
    next
    edit 4
        set name "DMZ-Mail-Server-Inbound"
        set srcintf "wan1"
        set dstintf "dmz"
        set action accept
        set srcaddr "all"
        set dstaddr "Mail-Server"
        set schedule "always"
        set service "SMTP" "SMTPS" "IMAP" "IMAPS" "POP3"
        set nat enable
        set logtraffic all
    next
    edit 5
        set name "Block-DMZ-to-LAN"
        set srcintf "dmz"
        set dstintf "lan"
        set action deny
        set srcaddr "DMZ-Servers"
        set dstaddr "Internal-Network"
        set schedule "always"
        set service "ALL"
        set logtraffic all
        set comments "Security policy - prevent DMZ from accessing internal network"
    next
    edit 6
        set name "Admin-Management-Access"
        set srcintf "lan"
        set dstintf "wan1"
        set action accept
        set srcaddr "Internal-Network"
        set dstaddr "all"
        set schedule "always"
        set service "SSH" "HTTPS-8443"
        set logtraffic all
    next
    edit 7
        set name "DNS-Resolution"
        set srcintf "lan"
        set dstintf "wan1"
        set action accept
        set srcaddr "Internal-Network"
        set dstaddr "all"
        set schedule "always"
        set service "DNS"
        set nat enable
        set logtraffic utm
    next
    edit 8
        set name "VPN-Remote-Access"
        set srcintf "wan1"
        set dstintf "lan"
        set action accept
        set srcaddr "all"
        set dstaddr "Internal-Network"
        set schedule "always"
        set service "IKE" "ESP"
        set logtraffic all
        set comments "Allow IPSec VPN connections"
    next
    edit 9
        set name "NTP-Sync"
        set srcintf "lan"
        set dstintf "wan1"
        set action accept
        set srcaddr "Internal-Network"
        set dstaddr "all"
        set schedule "always"
        set service "NTP"
        set nat enable
        set logtraffic disable
    next
    edit 10
        set name "Deny-All-Default"
        set srcintf "any"
        set dstintf "any"
        set action deny
        set srcaddr "all"
        set dstaddr "all"
        set schedule "always"
        set service "ALL"
        set logtraffic all
        set comments "Default deny rule - catch all"
    next
end

config router static
    edit 1
        set gateway 203.0.113.254
        set device "wan1"
    next
end

config system dns
    set primary 8.8.8.8
    set secondary 8.8.4.4
end
